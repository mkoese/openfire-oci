apiVersion: v1
kind: Secret
metadata:
  name: {{ .Release.Name }}-openfire-conf
type: Opaque
stringData:
  openfire.xml: |
    <?xml version="1.0" encoding="UTF-8"?>
    <jive>
        <adminConsole>
            <port>19090</port>
            <securePort>19091</securePort>
        </adminConsole>

        <!-- External PostgreSQL database (recommended for production) -->
        <!-- Uncomment and configure for production use -->
        <!--
        <connectionProvider>
            <className>org.jivesoftware.database.DefaultConnectionProvider</className>
        </connectionProvider>
        <database>
            <defaultProvider>
                <driver>org.postgresql.Driver</driver>
                <serverURL>jdbc:postgresql://postgres:5432/openfire</serverURL>
                <username>openfire</username>
                <password>changeme</password>
                <minConnections>5</minConnections>
                <maxConnections>25</maxConnections>
                <connectionTimeout>1.0</connectionTimeout>
            </defaultProvider>
        </database>
        -->

        <!-- Embedded database (development only) -->
        <connectionProvider>
            <className>org.jivesoftware.database.EmbeddedConnectionProvider</className>
        </connectionProvider>

        <setup>false</setup>
        <locale>en</locale>
        <fqdn>localhost</fqdn>

        <xmpp>
            <domain>localhost</domain>
            <socket>
                <port>15222</port>
                <ssl>
                    <port>15223</port>
                    <active>true</active>
                </ssl>
            </socket>
        </xmpp>

        <!-- TLS/SSL Configuration (configure later) -->
        <!--
        <ssl>
            <storeType>jks</storeType>
            <keystore>/opt/openfire/resources/security/keystore</keystore>
            <keystorePassword>changeit</keystorePassword>
            <truststore>/opt/openfire/resources/security/truststore</truststore>
            <truststorePassword>changeit</truststorePassword>
        </ssl>
        -->
    </jive>
